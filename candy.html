<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³–æœå±‹ï¼šè‘›éº—ç‰¹çš„é€†è¥²</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #2c0e0e; /* æ·±ç´…è¤è‰²èƒŒæ™¯ */
            color: #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
        }

        h1 { margin-top: 15px; color: #e74c3c; text-shadow: 2px 2px 0 #000; }

        /* éŠæˆ²ä¸»ç•«é¢ (æˆ¿é–“) */
        .room-container {
            width: 90%;
            max-width: 600px;
            height: 350px;
            background-color: #4a2c2c;
            border: 4px solid #8e44ad;
            border-radius: 10px;
            position: relative;
            margin-top: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            overflow: hidden;
            background-image: radial-gradient(circle, #5e3b3b 10%, #2c0e0e 90%);
        }

        /* æˆ¿é–“å…§çš„ç‰©ä»¶ */
        .obj {
            position: absolute;
            cursor: pointer;
            transition: transform 0.2s;
            text-align: center;
            font-size: 3rem;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5));
        }
        .obj:hover { transform: scale(1.1); filter: drop-shadow(0 0 10px #f1c40f); }
        .obj-label { font-size: 0.9rem; background: rgba(0,0,0,0.7); color: white; padding: 2px 5px; border-radius: 4px; display: block; margin-top: -10px; pointer-events: none;}

        /* ä½ç½®è¨­å®š */
        #cage { top: 30px; left: 30px; font-size: 4rem; } /* éŸ“è³½çˆ¾çš„ç± å­ */
        #oven { bottom: 20px; right: 30px; font-size: 5rem; } /* çƒ¤ç®± */
        #witch { top: 80px; right: 120px; font-size: 4.5rem; display: none; } /* å¥³å·« */
        #table { bottom: 20px; left: 50px; font-size: 4rem; } /* æ¡Œå­ */
        #cupboard { top: 30px; right: 30px; font-size: 4rem; } /* æ«¥æ«ƒ */

        /* é“å…·æ¬„ */
        .inventory-box {
            width: 90%; max-width: 600px;
            background: #222;
            border: 2px solid #555;
            padding: 10px;
            margin-top: 10px;
            display: flex;
            gap: 10px;
            min-height: 60px;
            align-items: center;
        }
        .inv-title { font-size: 0.9rem; color: #aaa; margin-right: 10px; }
        .item {
            background: #444; border: 1px solid #777; padding: 5px 10px; border-radius: 5px; cursor: pointer;
        }
        .item.selected { border: 2px solid #f1c40f; background: #555; }

        /* å°è©±æ¡† */
        .dialogue-box {
            width: 90%; max-width: 600px;
            height: 120px;
            background: rgba(0,0,0,0.8);
            border: 2px solid #e74c3c;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            font-size: 1rem;
            line-height: 1.5;
            overflow-y: auto;
        }
        .speaker { color: #f1c40f; font-weight: bold; margin-bottom: 5px; display: block; }
        
        /* æ“ä½œæŒ‰éˆ•å€ */
        .action-area { margin-top: 10px; display: flex; gap: 10px; }
        .btn { padding: 8px 16px; background: #e67e22; border: none; color: white; border-radius: 5px; cursor: pointer; font-weight: bold; display: none; }
        .btn:hover { background: #d35400; }

        /* çµå±€é®ç½© */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 100;
            display: none; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; color: white; padding: 20px;
        }
    </style>
</head>
<body>

    <h1>ğŸ¬ ç³–æœå±‹ï¼šè‘›éº—ç‰¹çš„é€†è¥²</h1>

    <div class="room-container">
        <div class="obj" id="cage" onclick="interact('cage')">
            â›“ï¸ğŸ‘¦
            <span class="obj-label">å“¥å“¥çš„ç± å­</span>
        </div>
        
        <div class="obj" id="witch" onclick="interact('witch')">
            ğŸ§™â€â™€ï¸
            <span class="obj-label">ççœ¼å¥³å·«</span>
        </div>

        <div class="obj" id="oven" onclick="interact('oven')">
            ğŸ”¥
            <span class="obj-label">å¤§çƒ¤ç®±</span>
        </div>

        <div class="obj" id="table" onclick="interact('table')">
            ğŸ—
            <span class="obj-label">å‰©èœæ¡Œ</span>
        </div>

        <div class="obj" id="cupboard" onclick="interact('cupboard')">
            ğŸ—„ï¸
            <span class="obj-label">é›œç‰©æ«ƒ</span>
        </div>
    </div>

    <div class="inventory-box">
        <span class="inv-title">æŒæœ‰ç‰©å“:</span>
        <div id="inv-container" style="display:flex; gap:10px;"></div>
    </div>

    <div class="dialogue-box">
        <span class="speaker" id="speaker-name">ç³»çµ±</span>
        <span id="dialogue-text">éŠæˆ²é–‹å§‹ã€‚å¦³æ˜¯è‘›éº—ç‰¹ï¼Œå“¥å“¥è¢«é—œèµ·ä¾†äº†ï¼Œå¥³å·«æ­£åœ¨æº–å‚™ä»Šå¤©çš„æ™šé¤...ä¹Ÿå°±æ˜¯å“¥å“¥ã€‚å¦³å¿…é ˆæƒ³è¾¦æ³•æ•‘ä»–ï¼</span>
    </div>

    <div class="action-area">
        <button class="btn" id="btn-push" onclick="pushWitch()">âœ‹ æŠŠå¥¹æ¨é€²å»ï¼</button>
    </div>

    <div id="overlay" class="overlay">
        <h2 id="end-title" style="font-size: 2.5rem; color: #f1c40f;"></h2>
        <p id="end-desc" style="font-size: 1.1rem; line-height: 1.6; max-width: 500px; color: #ccc; margin-bottom: 30px;"></p>
        <div style="background:#333; padding:15px; border-left:4px solid #e74c3c; text-align:left; font-size:0.9rem; max-width:500px;">
            <strong>ã€åœ–æ›¸è³‡è¨Šå­¸è§€é»ã€‘</strong><br>
            <span id="lib-note"></span>
        </div>
        <button class="btn" style="display:inline-block; margin-top:20px;" onclick="location.reload()">é‡æ–°é–‹å§‹</button>
    </div>

<script>
    // --- éŠæˆ²ç‹€æ…‹ ---
    let inventory = [];
    let selectedItem = null;
    let phase = 0; 
    // 0: å°‹æ‰¾éª¨é ­
    // 1: é¤µé£Ÿæª¢æŸ¥ (ä½¿ç”¨éª¨é ­)
    // 2: çƒ¤ç®±å‰ç½® (è£å‚»)
    // 3: æ±ºæˆ° (æ¨å¥³å·«)

    // --- æ–‡æœ¬è³‡æ–™åº« ---
    const texts = {
        start: "å¥³å·«æ­£åœ¨é‚£é‚Šç£¨åˆ€éœéœã€‚å¥¹èªªï¼šã€Œå»çœ‹çœ‹é‚£å€‹ç”·å­©é•·è‚‰äº†æ²’ï¼Ÿè¦æ˜¯å¤ èƒ–äº†ï¼Œæˆ‘ä»Šå¤©å°±æŠŠä»–çƒ¤ä¾†åƒï¼ã€\n(æç¤ºï¼šå“¥å“¥å¤ªç˜¦äº†æœƒè¢«åƒæ‰ï¼Œå¾—æ‰¾å€‹æ±è¥¿é¨™é¨™é‚£å€‹ççœ¼è€å¤ªå©†...)",
        findBone: "æˆ‘åœ¨æ¡Œä¸Šçš„å‰©èœå †è£¡æ‰¾åˆ°äº†ä¸€æ ¹ã€Œåƒå‰©çš„é›éª¨é ­ã€ã€‚é€™æ±è¥¿ç¡¬ç¡¬ç´°ç´°çš„ï¼Œæ‘¸èµ·ä¾†æœ‰é»åƒæ‰‹æŒ‡...",
        witchCheck: "å¥³å·«å¤§å–Šï¼šã€ŒæŠŠæ‰‹æŒ‡ä¼¸å‡ºä¾†ï¼è®“æˆ‘æ‘¸æ‘¸çœ‹é•·è‚‰äº†æ²’ï¼ã€\n(è«‹é»æ“Šé“å…·æ¬„çš„éª¨é ­ï¼Œç„¶å¾Œé»æ“Šå¥³å·«)",
        successBone: "å¥³å·«æ‘¸äº†æ‘¸é›éª¨é ­ï¼Œçšºè‘—çœ‰é ­èªªï¼šã€Œæ€éº¼é‚„æ˜¯é€™éº¼ç˜¦ï¼Ÿåƒæ¯æ¨¹æä¸€æ¨£ï¼ç®—äº†ï¼Œé‚„æ˜¯å…ˆç†±çƒ¤ç®±å§ã€‚ã€",
        failBone: "å¦³æ²’æœ‰æ‹¿å‡ºæ±è¥¿é¨™å¥¹ã€‚å¥³å·«æ‘¸äº†å“¥å“¥çš„æ‰‹æŒ‡ï¼Œå¤§å«ï¼šã€Œå“‡ï¼è‚‰å¾ˆå¤šå˜›ï¼ä»Šå¤©å°±åƒçƒ¤äººè‚‰ï¼ã€(Game Over)",
        ovenPhase: "å¥³å·«èµ°å‘çƒ¤ç®±ï¼Œç«ç‡’å¾—å¾ˆæ—ºã€‚å¥¹è½‰é ­å°å¦³èªªï¼šã€Œè‘›éº—ç‰¹ï¼Œçˆ¬é€²å»çœ‹çœ‹æº«åº¦å¤ ä¸å¤ ï¼Ÿã€\n(åƒè¬ä¸èƒ½é€²å»ï¼è¦æƒ³è¾¦æ³•æ‹’çµ•å¥¹)",
        playDumb: "å¦³è£å‡ºä¸€å‰¯ç¬¨æ‹™çš„æ¨£å­ï¼šã€Œæˆ‘ä¸æ‡‚...é€™å€‹æ´é€™éº¼å°ï¼Œæˆ‘æ€éº¼é€²å¾—å»ï¼Ÿã€\nå¥³å·«ä¸è€ç…©äº†ï¼šã€Œç¬¨è›‹ï¼é€£é€™éƒ½ä¸æœƒï¼Ÿçœ‹æˆ‘ç¤ºç¯„çµ¦å¦³çœ‹ï¼ã€",
        climax: "å¥³å·«æŠŠé ­æ¢é€²äº†çƒ¤ç®±...é€™æ˜¯åƒè¼‰é›£é€¢çš„æ©Ÿæœƒï¼"
    };

    // --- äº’å‹•é‚è¼¯ ---
    function interact(target) {
        const dialog = document.getElementById('dialogue-text');
        const speaker = document.getElementById('speaker-name');

        // 1. é»æ“Šæ¡Œå­ (ç²å¾—éª¨é ­)
        if (target === 'table') {
            if (!hasItem('bone')) {
                addItem('bone', 'ğŸ— é›éª¨é ­');
                speaker.innerText = "è‘›éº—ç‰¹";
                dialog.innerText = texts.findBone;
                // æ¨é€²åŠ‡æƒ…
                setTimeout(() => {
                    document.getElementById('witch').style.display = 'block';
                    speaker.innerText = "å¥³å·«";
                    dialog.innerText = texts.witchCheck;
                    phase = 1;
                }, 3000);
            } else {
                dialog.innerText = "æ¡Œä¸Šåªå‰©ä¸‹çˆ›èœè‘‰äº†ï¼Œæ²’æœ‰å…¶ä»–æœ‰ç”¨çš„æ±è¥¿ã€‚";
            }
        }

        // 2. é»æ“Šå¥³å·« (é—œéµäº’å‹•)
        if (target === 'witch') {
            if (phase === 1) {
                if (selectedItem === 'bone') {
                    // æˆåŠŸé¨™é
                    speaker.innerText = "å¥³å·«";
                    dialog.innerText = texts.successBone;
                    // ç§»é™¤éª¨é ­
                    removeItem('bone');
                    phase = 2;
                    setTimeout(startOvenPhase, 3000);
                } else {
                    // å¤±æ•—
                    speaker.innerText = "å¥³å·«";
                    dialog.innerText = "å¦³åœ¨å¹¹å˜›ï¼Ÿå¿«å«å¦³å“¥å“¥æŠŠæ‰‹æŒ‡ä¼¸å‡ºä¾†ï¼(å¦‚æœå¦³æ²’æ±è¥¿é¨™å¥¹ï¼Œå¾Œæœä¸å ªè¨­æƒ³...)";
                }
            } else if (phase === 2) {
                dialog.innerText = "å¥¹æ­£åœ¨å¿™è‘—å¼„çƒ¤ç®±ï¼Œç¾åœ¨é è¿‘å¥¹å¤ªå±éšªäº†ã€‚";
            }
        }

        // 3. é»æ“Šçƒ¤ç®±
        if (target === 'oven') {
            if (phase === 2) {
                speaker.innerText = "è‘›éº—ç‰¹";
                dialog.innerText = texts.playDumb;
                phase = 3;
                setTimeout(() => {
                    document.getElementById('btn-push').style.display = 'block'; // é¡¯ç¤ºæ¨äººæŒ‰éˆ•
                    dialog.innerText = texts.climax;
                }, 3000);
            } else if (phase < 2) {
                dialog.innerText = "ç«ç‡’å¾—å¾ˆæ—ºï¼Œçœ‹èµ·ä¾†éå¸¸ç‡™ã€‚";
            }
        }

        // 4. å…¶ä»–ç‰©ä»¶
        if (target === 'cage') {
            speaker.innerText = "éŸ“è³½çˆ¾";
            dialog.innerText = "ã€Œè‘›éº—ç‰¹...æ•‘æˆ‘...è€å¤ªå©†è¦æŠŠæˆ‘åƒæ‰äº†...ã€";
        }
        if (target === 'cupboard') {
            dialog.innerText = "æ«ƒå­é–ä½äº†ï¼Œè£¡é¢å¥½åƒè—è‘—å¥³å·«çš„ç å¯¶ï¼Œä½†ç¾åœ¨é€ƒå‘½è¦ç·Šã€‚";
        }
    }

    // --- éšæ®µæ§åˆ¶ ---
    function startOvenPhase() {
        document.getElementById('speaker-name').innerText = "å¥³å·«";
        document.getElementById('dialogue-text').innerText = texts.ovenPhase;
    }

    function pushWitch() {
        endGame(true);
    }

    // --- é“å…·ç³»çµ± ---
    function addItem(id, name) {
        inventory.push(id);
        const div = document.createElement('div');
        div.className = 'item';
        div.innerText = name;
        div.id = 'item-' + id;
        div.onclick = () => selectItem(id);
        document.getElementById('inv-container').appendChild(div);
    }

    function removeItem(id) {
        const idx = inventory.indexOf(id);
        if (idx > -1) inventory.splice(idx, 1);
        const el = document.getElementById('item-' + id);
        if (el) el.remove();
        selectedItem = null;
    }

    function selectItem(id) {
        selectedItem = id;
        document.querySelectorAll('.item').forEach(el => el.classList.remove('selected'));
        document.getElementById('item-' + id).classList.add('selected');
        document.getElementById('dialogue-text').innerText = `(å¦³æ‰‹ä¸Šæ‹¿è‘— ${id === 'bone' ? 'é›éª¨é ­' : 'æœªçŸ¥ç‰©å“'}ï¼Œæº–å‚™å°èª°ä½¿ç”¨ï¼Ÿ)`;
    }

    function hasItem(id) {
        return inventory.includes(id);
    }

    // --- çµå±€ç³»çµ± ---
    function endGame(win) {
        const overlay = document.getElementById('overlay');
        const title = document.getElementById('end-title');
        const desc = document.getElementById('end-desc');
        const note = document.getElementById('lib-note');

        overlay.style.display = 'flex';

        if (win) {
            title.innerText = "ğŸ† é€ƒè„«æˆåŠŸï¼";
            desc.innerText = "å¦³ç”¨åŠ›ä¸€æ¨ï¼ŒæŠŠå£å¿ƒçœ¼çš„å¥³å·«æ¨é€²äº†ç«çˆï¼å¦³æ•‘å‡ºäº†å“¥å“¥ï¼Œä¸¦åœ¨æ«ƒå­è£¡ç™¼ç¾äº†çç å¯¶çŸ³ï¼Œå…©äººå¹³å®‰å›åˆ°äº†å®¶ã€‚";
            note.innerText = "åœ¨é€™å€‹æƒ…ç¯€ä¸­ï¼Œé›éª¨é ­è±¡å¾µè‘—ã€Œè³‡æ–™å½é€  (Data Spoofing)ã€ï¼Œç”¨ä¾†æ¬ºé¨™ç›£æ§ç³»çµ±ï¼ˆå¥³å·«çš„è§¸è¦ºæª¢æŸ¥ï¼‰ã€‚è€Œæœ€å¾Œçš„è£å‚»ï¼Œå‰‡æ˜¯å…¸å‹çš„ã€Œç¤¾æœƒå·¥ç¨‹å­¸ (Social Engineering)ã€ï¼Œåˆ©ç”¨äººæ€§çš„å¼±é»ï¼ˆå¥³å·«çš„è‡ªå¤§ï¼‰ä¾†çªç ´é˜²ç¦¦ã€‚";
        }
    }

    // åˆå§‹åŒ–æç¤º
    document.getElementById('speaker-name').innerText = "åŠ‡æƒ…æ—ç™½";
    document.getElementById('dialogue-text').innerText = texts.start;

</script>
</body>
</html>
